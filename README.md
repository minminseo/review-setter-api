# Review Setter
復習スケジュール管理の負担を減らすためのWebアプリです。
好きな復習スケジュールのテンプレート（以降「パターン」と呼ぶ）を作成し、それらのパターンを使い分けることで学習の内容に合わせて個別の復習スケジュールを作成することができます。

このアプリは[ふろむだ (id:fromdusktildawn)](https://www.furomuda.com/about)氏の「[最新研究からわかる 学習効率の高め方](https://www.furomuda.com/entry/2020/10/04/031633)」で言及されている
> カーピキー2008実験の《弱点勉強・全テスト》

と、安川 康介氏の「[科学的根拠に基づく最高の勉強法](https://www.amazon.co.jp/%E7%A7%91%E5%AD%A6%E7%9A%84%E6%A0%B9%E6%8B%A0%E3%81%AB%E5%9F%BA%E3%81%A5%E3%81%8F%E6%9C%80%E9%AB%98%E3%81%AE%E5%8B%89%E5%BC%B7%E6%B3%95-%E5%AE%89%E5%B7%9D-%E5%BA%B7%E4%BB%8B-ebook/dp/B0CTMFNJX8/ref=sr_1_1?adgrpid=164656178390&dib=eyJ2IjoiMSJ9.CbcnC0nC3JY_zSWw9PHCC0kiIeeqKKRYhBF_OFmlJLHkIZoWjJYYxDTL-HXMFa7mF9wgmaZZ_KmZsE112ZEdcCNVKLyp85ltpX3LsvJuRq_H5rdL3-FVw9jpFSUzJN8bbhQDHxWUE3hFkELUTpjUSQ.zGST5LyADDMe9EUdTMzYnknmh2mCo1Zl623-rb5SKbM&dib_tag=se&hvadid=696068883067&hvdev=c&hvexpln=0&hvlocphy=1009228&hvnetw=g&hvocijid=4888524000737590284--&hvqmt=e&hvrand=4888524000737590284&hvtargid=kwd-1187604065653&hydadcr=17959_13654746&jp-ad-ap=0&keywords=%E7%A7%91%E5%AD%A6%E7%9A%84%E3%81%AA%E5%8B%89%E5%BC%B7%E6%B3%95&mcid=4bf68f32979d3a2ea8bb77d6c7ac2a4e&qid=1755241730&sr=8-1)」の復習タイミングに関する言及の
> 「等間隔か、徐々に延ばすのか」という問題は、僕の知る限り決着がついていません。そもそも、学習者の元々の知識量や勉強する内容の量や難しさ（忘れやすさ）などによって異なってくるのではないかと予想します。
> （安川 康介. 科学的根拠に基づく最高の勉強法 (p. 76)）

と
> アクティブリコール+分散学習=連続的再学習
> （安川 康介. 科学的根拠に基づく最高の勉強法 (p. 241)）

の考え方を基準にしています。
##### アクティブリコール、分散学習、連続的再学習とは
アクティブリコールは同書籍の説明が分かりやすいため引用すると、
> 勉強したことや覚えたいことを、能動的に思い出すこと、記憶から引き出すこと
> （安川 康介. 科学的根拠に基づく最高の勉強法 (p. 45)）

とされています。
分散学習とは、「時間（日にち）をあけて繰り返し勉強すること」です。
連続的再学習とは「アクティブリコールと分散学習を組み合わせた学習法」のことです。

つまり、**日にちをあけて繰り返し全テスト（思い出す）するという復習法を様々な復習タイミングのパターンで復習できるようにすること**が本アプリの目的となっています。

また復習管理の労力を最小限にするために、ユーザーが主に記録するのは復習した内容の概要となっていて、あくまで"**今日テストするのは何かを辞書的に確認する**"という使い方を想定しているため、勉強した内容を詳細に記録しそれを見て復習する用途には向いていません（オプションとしてそういった詳細を記録する機能も用意し、自由度を確保しています）。

#### 作ったサービス
https://reviewsetter.dpdns.org
※現在レスポンシブ対応していません(今後対応)。

#### フロントエンド
フロントエンドは別リポジトリです。
https://github.com/minminseo/review-setter-client

# 開発の背景
復習スケジュールは適切に組めばとても効果的です。しかし、スケジュールを組む以上それを管理する労力が少なからず発生します。

**「複数の復習スケジュールを組む」**、**「復習済みかどうか判断する」**、**「サボってしまった時のスケジュールのズレを考慮する」** など、復習スケジュール管理には様々な要素が存在し、しっかり管理しようとするとそれなりに面倒です。この管理に割かれる労力が増え、返って復習効率が悪くなる可能性もあります。
同様のサービスはすでに多く存在しますが、人それぞれ使いやすいと感じる管理方法は異なります。当然自分に完璧にピッタリ合うサービスというのは中々存在しないためある程度の妥協は必要ですが、復習はこだわりたいなと思い当初はスプレッドシートで管理していました。

ただ、徐々に管理が大変になりGASで改良しないといけなくなったり、もう少し復習に特化したUIで復習したくなったこともあり、復習スケジュール管理に割かれる労力をできるだけ減らすことを目標に個人で開発することにしました。

# 解決したい課題

- スケジュール通りに復習しなかった時のリスケジュール作業が少し面倒で復習に集中しづらい
- 勉強の内容毎に異なる日付け間隔で復習スケジュールを組もうとすると管理が複雑で大変
- 復習スケジュール管理にできるだけワーキングメモリを消費したくない


# 使用技術
#### プログラミング言語
- Go

#### データベース
- PostgreSQL

#### フレームワーク/ライブラリなど
- labstack/echo
- sqlc
- golang-migrate/migrate

#### CI
- GitHub Actions

## サービスの構造
ユーザーが作成した**パターン**はこの**ボックス**に適用することができます。

**ボックス**に**復習物**が登録されると、**ボックス**に適用されている**パターン**をもとに復習スケージュールが生成されます。

また、**ホーム**に対して1つと**カテゴリー**毎に1つずつ「**未分類復習物ボックス**」というものが存在します。これはどの**ボックス**に**復習物**を登録すべきか迷ったときに一時的に登録するための**ボックス**です。（この**ボックス**には**パターン**は適用不可で**復習物**毎に別々の**パターン**を適用可能。）

![MacBook Pro 14_ - 28.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3654936/0f7ece0b-c61a-4c41-973e-3c65db033304.png)


# 機能一覧
### ユーザー関連
- 基本的なユーザー認証（サインアップ、ログイン、ログアウト）機能
- メールで送信される6桁の認証コードによるメール認証機能
- ユーザー設定（タイムゾーン、テーマカラー、言語）の取得・更新機能
- パスワード更新機能

### カテゴリー関連
- カテゴリーの作成、一覧取得、更新、削除機能

### ボックス関連
- ボックスの作成、一覧取得、更新、削除機能

### パターン関連
- パターンの作成、一覧取得、更新、削除機能
- パターンをボックスに適用する機能。
  - ボックス内に復習物が作成された時、ボックスに適用されたパターンをもとに自動で復習スケジュール（復習日）を生成する機能。
- パターンを未分類復習物ボックスに作成された復習物に適用し、自動で復習スケジュール（復習日）を生成する機能。（未分類ボックスに限り、復習物単位でパターンを適用できる）

### 復習物関連
- 復習物の作成、更新、削除機能
- 条件別（未完了、完了済み）の復習物一覧取得機能
- 復習日（その日の復習）の完了・未完了を切り替える機能
- 復習物の強制完了・再開機能
- その日に復習が予定されている復習の一覧取得機能
- 特定の復習日を昨日以前に戻す機能

### データ集計関連
- ボックスやカテゴリごとの未完了復習物、未完了復習日を集計する機能
- その日の復習予定数を集計する機能

### バッチ処理関連
- 復習日が未完了の状態でユーザー設定のタイムゾーンで日付けを跨いだ時、自動的にその復習日をプラス1日する機能。

### その他機能
- カテゴリー、ボックス、復習物の並び替え機能
- ボックス内部画面での復習物絞り込み機能

## サービスの使い方（主要画面抜粋）

### 1. 復習物作成モーダル
新しい復習物を作成するための入力フォームです。
- 「**復習物名**」、「**詳細（任意）**」、「**学習日**」に加え、どの「**カテゴリ**」のどの「**ボックス**」に属させるかを選択します。所属するボックスが設定されると、そのボックスに紐づいた復習パターンが自動で適用されます。ただし、ユーザー作成系のボックスの場合はパターンはそのボックスが持つものに固定されます（未分類系ボックスの場合はパターン選択可能）。
- また、このモーダルのカテゴリとボックスの選択肢はどの画面からこのモーダルを開いたかに応じて初期値が自動で設定されます。

![create-item-modal.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3654936/59191088-177e-4fc1-9b84-a6e50f168dc7.png)

### 2. パターン作成モーダル
復習スケジュールをカスタマイズするための画面です。
- 「**パターン名**」と学習の優先度を示す「**重み**」を設定し、「**ステップ**」で何日後に復習するかを自由に定義することができます。例えば、「1日後、3日後、7日後...」といった具体的なステップを数値で入力して、独自の復習スケジュールのパターンを作成します。

![create-pattern-modal.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3654936/7f284156-368d-4e71-a6c1-e7cc3a23af48.png)

### 3. カテゴリー内部画面
特定のカテゴリ（この例では「プログラミング」）に属するボックスの一覧画面です。
- 各ボックスには、含まれる全復習物数と、そのうち今日が復習日の復習物数が表示されています。
- 「ボックス作成」ボタンからこのカテゴリに新しいボックスを追加することができます（ボックス作成時には、**「名前」** と **「パターン」** を設定する必要があります）。
- 画面上部に表示されているカテゴリータブとボックスタブでカテゴリー、ボックス間を移動することができます。

![:home:category-example.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3654936/abeba5d7-7f5a-4d4d-8f24-d7e5af7c0ae3.png)


### 4. ボックス内部画面
特定のボックス（この例では「高頻度」）に含まれる復習物の一覧です。
- 「**復習物を作成**」ボタンからこのボックスに新しい復習物を追加することができます。
- 復習日が今日の復習物の左には、「**完了/取消**」ボタンが表示され、クリックすると状態を操作することができます。
- 全ての復習日が完了、もしくは復習物を強制完了（鉛筆マーククリックで表示される画面から可能）した場合、スケジュールテーブル上部辺りにある「**完了済みを確認**」ボタンをクリックしたときに表示される画面に移動します。そこではこれまで完了させてきた復習物一覧を確認することができます。

<font color="rgb(107, 142, 35)">**緑色の日付：**</font> 過去の完了済み復習日。
<font color="rgba(21, 76, 193, 1)">**青色の日付（暗）：**</font> 今日の復習（完了済み状態）。
<font color="#142657ff">**青色の日付（明）：**</font> 今日の復習（未完了状態）。クリックすると復習日変更画面が表示され、そこで復習日を過去に変更して完了状態にすることができます。（後続の復習日は復習日の変更幅に従って再スケジューリングされます。）

![:home:category:box-example-with-sidebar.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3654936/6b242eb4-31cf-470f-8e72-7a9e0a94661f.png)

### 5. 今日の復習画面
今日の日付が復習日に設定されている復習物が一覧表示される画面です。
- ここでも復習の**完了/取消**を操作をすることができます。
- ボックスへ移動ボタンをクリックすると、そのときに開いている条件の画面へ移動することができます。
  - 例：「**全て-全て**」ならホーム、「**プログラミング-全て**」ならプログラミングカテゴリー内部画面、「**プログラミング-高頻度**」ならプログラミング-高頻度ボックス内部画面へ移動。
- 画面上部に表示されているカテゴリータブとボックスタブでカテゴリー、ボックス毎の今日の復習画面を移動することができます。

![:home:today:programming-example-with-sidebar.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3654936/01eae4b5-1f44-4a27-b25d-7d5470b1b8c6.png)

### 6. ホーム画面

![:home-with-sidebar.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3654936/1d0277d2-2fe4-4fc7-af73-e0282fdb1568.png)


# ER図
![er.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3654936/3d420b1c-9008-4fd6-b088-7e5528b83a2e.png)

# 画面遷移図
[画面遷移図](https://boardmix.com/app/share/CAE.CL7hlQEgASoQBIZxvJlwyJDzuRSXDb05hjAGQAE/GtN0fk "")

# 今後追加を考えている機能
- 今日の復習一覧のメール通知機能の追加
- 生成AIを使った、ユーザーが貼り付けた文章から復習物を分割抽出して、復習物として一括作成できる機能
- 学習内容を特定のノートアプリ等（ここではNotionを例に扱う）に記録しているユーザーの場合、Notion APIの更新履歴情報からどういった内容を記録したかを取得→復習物として自動作成し、ユーザーアクセス時に「自動作成された復習物」を一覧表示し、取捨選択できるようにする機能の追加
- 昨日以前の完了済み復習物を未完了にして今日に戻せる機能の追加
- あるボックスに対して、完了済み復習物/復習日が一つもない場合にボックスに設定されているパターンを変更できる機能の追加
- 復習物一覧やパターン一覧など、並び替え機能のある画面の並び替えのデフォルト状態設定をユーザーが設定できる機能の実装
- モチベアップが促されるような過去の復習記録を見られるページの追加
- ドラッグ&ドロップで復習物をボックス間で移動させられる機能の追加
- 復習物の「詳細」で画像やハイパーリンクに対応する（現在はテキストのみ）
- 復習物の一括完了/削除/移動機能の追加
- パスワードを忘れた時用のパスワード変更機能の追加
- レスポンシブ対応

# セットアップ

### 必要なもの
- Docker
- Git
- Goの実行環境
- Gmailメール送信用のSMTPサーバーアカウント

### 手順
```bash
git clone https://github.com/minminseo/review-setter-api.git
cd review-setter-api
cp .env.example .env

# 下記のように32バイトの乱数の16進数文字列を2つ生成し、.envファイルのENCRYPTION_KEYとHMAC_SECRET_KEYに設定
openssl rand -hex 32
openssl rand -hex 32
```

.envファイルで、アカウント新規作成時の認証メール送信先としてGmailの**SMTP_USER**と**SMTP_PASS**をそれぞれ設定。

```bash
docker-compose up -d --build

migrate -path migrations -database "postgres://review-setter:review-setter@localhost:5435/review-setter?sslmode=disable" -verbose up

GO_ENV=dev go run cmd/api/main.go
```
<br>

[フロントエンドのリポジトリ](https://www.furomuda.com/about)をセットアップ。